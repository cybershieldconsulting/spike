{% extends "misc/application.html" %}
{% block title %}Create Naxsi-Rule{% endblock %}


{% block main %}

    <h2>New Rule</h2>

    <form action="{{ url_for('rules.new') }}" method="POST">

        <div class="row top-buffer1">
            <div class="col-md-1">
                <h5>SID</h5>
            </div>

            <div class="col-md-6">
                {{ latestn }}
            </div>
        </div>


        <div class="row top-buffer1">
            <div class="col-md-1">
                <h5>Message</h5>
            </div>

            <div class="col-md-6">
                <input type="text" name="msg" size="60" placeholder="Message" required>
            </div>
        </div>


        <div class="row top-buffer1">
            <div class="col-md-1">
                <h5>Detect</h5>
            </div>

            <div class="col-md-6">
                <input type="text" name="detection" size="60" placeholder="str|rx" required>
            </div>
        </div>


        <div class="row top-buffer1">
            <div class="col-md-1">
                <h5>Matchzone</h5>
            </div>

            <div class="col-md-6">
                {% for z in mz %}
                    <input title="matchzone" type="checkbox" name="mz" value="{{ z }}"> {{ z }} <br>
                {% endfor %}
                <input title="custom_mz" type="checkbox" name="custom_mz" value="on">
                <input title="custom_mz_val" type="text" name="custom_mz_val" placeholder="Custom MZ">
            </div>
        </div>


        <div class="row top-buffer1">
            <div class="col-md-1">
                <h5>Negative</h5>
            </div>

            <div class="col-md-6">
                <input title="negative" type="checkbox" name="negative" value="checked">
            </div>
        </div>


        <div class="row top-buffer1">
            <div class="col-md-1">
                <h5>Score</h5>
            </div>

            <div class="col-md-6">
               {% for s in score %}
                    <input title="score_{{ s }}" type="text" name="score_{{ s }}" value="8" size="3">
                    <input title="{{ s }}" type="checkbox" name="score" value="{{ s }}"> {{ s }}
                    <br>
                {% endfor %}
            </div>
        </div>


        <div class="row top-buffer1">
            <div class="col-md-1">
                <h5>Remarks</h5>
            </div>

            <div class="col-md-6">
                <textarea cols="60" rows="10" name="rmks" title="remarks"></textarea>
            </div>
        </div>


        <div class="row top-buffer1">
            <div class="col-md-1">
                <h5>Ruleset</h5>
            </div>

            <div class="col-md-1">
                    <select title="ruleset" name="ruleset">
                        {% for r in rulesets %}
                            <option value="{{ r.name }}"> {{ r.name }}
                        {% endfor %}
                    </select>
            </div>

            <div class="col-md-1">
                <a href="{{ url_for('rulesets.index') }}" class="btn btn-info btn-xs">new ruleset</a>
            </div>
        </div>

    
        <div class="row top-buffer1">
            <div class="col-md-6">
                <button type="submit" class="btn btn-success btn-lg">Save Rule</button>
            </div>
        </div>
    </form>
{% endblock %}

